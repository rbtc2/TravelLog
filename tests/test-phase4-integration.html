<!DOCTYPE html>\n<html lang=\"ko\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>TravelLog Phase 4 통합 테스트</title>\n    <style>\n        body {\n            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n            max-width: 1200px;\n            margin: 0 auto;\n            padding: 20px;\n            background-color: #f8f9fa;\n        }\n        \n        .test-container {\n            background: white;\n            border-radius: 8px;\n            padding: 20px;\n            margin-bottom: 20px;\n            box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n        }\n        \n        .test-header {\n            border-bottom: 2px solid #007bff;\n            padding-bottom: 10px;\n            margin-bottom: 20px;\n        }\n        \n        .test-section {\n            margin-bottom: 30px;\n            padding: 15px;\n            border-left: 4px solid #28a745;\n            background-color: #f8f9fa;\n        }\n        \n        .test-result {\n            padding: 10px;\n            margin: 10px 0;\n            border-radius: 4px;\n            font-family: monospace;\n        }\n        \n        .test-pass {\n            background-color: #d4edda;\n            border: 1px solid #c3e6cb;\n            color: #155724;\n        }\n        \n        .test-fail {\n            background-color: #f8d7da;\n            border: 1px solid #f5c6cb;\n            color: #721c24;\n        }\n        \n        .test-info {\n            background-color: #cce7ff;\n            border: 1px solid #b8daff;\n            color: #004085;\n        }\n        \n        .stats-grid {\n            display: grid;\n            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));\n            gap: 15px;\n            margin: 15px 0;\n        }\n        \n        .stat-card {\n            background: white;\n            padding: 15px;\n            border-radius: 6px;\n            border: 1px solid #e0e0e0;\n        }\n        \n        .test-button {\n            background: #007bff;\n            color: white;\n            border: none;\n            padding: 10px 20px;\n            border-radius: 4px;\n            cursor: pointer;\n            margin: 5px;\n        }\n        \n        .test-button:hover {\n            background: #0056b3;\n        }\n        \n        .error-details {\n            background: #fff3cd;\n            border: 1px solid #ffeaa7;\n            color: #856404;\n            padding: 10px;\n            border-radius: 4px;\n            margin-top: 10px;\n            font-size: 0.9em;\n        }\n        \n        .performance-metrics {\n            display: grid;\n            grid-template-columns: repeat(3, 1fr);\n            gap: 10px;\n            margin: 15px 0;\n        }\n        \n        .metric {\n            text-align: center;\n            padding: 10px;\n            background: #f8f9fa;\n            border-radius: 4px;\n        }\n        \n        .metric-value {\n            font-size: 1.5em;\n            font-weight: bold;\n            color: #007bff;\n        }\n        \n        .metric-label {\n            font-size: 0.9em;\n            color: #6c757d;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"test-container\">\n        <div class=\"test-header\">\n            <h1>🧪 TravelLog Phase 4 통합 테스트</h1>\n            <p>리팩토링된 서비스들의 통합 테스트 및 성능 검증</p>\n        </div>\n        \n        <div class=\"test-section\">\n            <h2>🎯 테스트 제어</h2>\n            <button class=\"test-button\" onclick=\"runAllTests()\">전체 테스트 실행</button>\n            <button class=\"test-button\" onclick=\"runUtilityTests()\">유틸리티 테스트</button>\n            <button class=\"test-button\" onclick=\"runServiceTests()\">서비스 테스트</button>\n            <button class=\"test-button\" onclick=\"runPerformanceTests()\">성능 테스트</button>\n            <button class=\"test-button\" onclick=\"clearResults()\">결과 초기화</button>\n        </div>\n        \n        <div class=\"test-section\">\n            <h2>📊 테스트 결과 요약</h2>\n            <div class=\"performance-metrics\">\n                <div class=\"metric\">\n                    <div class=\"metric-value\" id=\"total-tests\">0</div>\n                    <div class=\"metric-label\">총 테스트</div>\n                </div>\n                <div class=\"metric\">\n                    <div class=\"metric-value\" id=\"passed-tests\">0</div>\n                    <div class=\"metric-label\">성공</div>\n                </div>\n                <div class=\"metric\">\n                    <div class=\"metric-value\" id=\"failed-tests\">0</div>\n                    <div class=\"metric-label\">실패</div>\n                </div>\n            </div>\n        </div>\n        \n        <div id=\"test-results\">\n            <!-- 테스트 결과가 여기에 표시됩니다 -->\n        </div>\n    </div>\n\n    <!-- 테스트 대상 모듈들 Import -->\n    <script type=\"module\">\n        // Phase 4에서 리팩토링된 유틸리티들 import\n        import { DateUtils } from '../js/modules/utils/date-utils.js';\n        import { CountryUtils } from '../js/modules/utils/country-utils.js';\n        import { StatsUtils } from '../js/modules/utils/stats-utils.js';\n        import { ValidationUtils } from '../js/modules/utils/validation-utils.js';\n        \n        // 서비스들 import (mockData 사용)\n        import { LogDataService } from '../js/modules/services/log-data-service.js';\n        import { CacheManager } from '../js/modules/services/cache-manager.js';\n        import { BasicStatsService } from '../js/modules/services/basic-stats-service.js';\n        import { CountryAnalysisService } from '../js/modules/services/country-analysis-service.js';\n        import { PurposeAnalysisService } from '../js/modules/services/purpose-analysis-service.js';\n        import { YearlyStatsService } from '../js/modules/services/yearly-stats-service.js';\n        \n        // 전역 변수로 설정하여 HTML에서 접근 가능하게 함\n        window.testModules = {\n            DateUtils,\n            CountryUtils,\n            StatsUtils,\n            ValidationUtils,\n            LogDataService,\n            CacheManager,\n            BasicStatsService,\n            CountryAnalysisService,\n            PurposeAnalysisService,\n            YearlyStatsService\n        };\n        \n        // 테스트 데이터\n        window.mockTravelLogs = [\n            {\n                id: '1',\n                country: 'JP',\n                city: '도쿄',\n                startDate: '2024-01-15',\n                endDate: '2024-01-20',\n                purpose: 'tourism',\n                rating: 4.5,\n                title: '도쿄 여행',\n                description: '도쿄에서의 즐거운 여행'\n            },\n            {\n                id: '2',\n                country: 'US',\n                city: '뉴욕',\n                startDate: '2024-03-10',\n                endDate: '2024-03-17',\n                purpose: 'business',\n                rating: 4.0,\n                title: '뉴욕 출장',\n                description: '비즈니스 미팅'\n            },\n            {\n                id: '3',\n                country: 'FR',\n                city: '파리',\n                startDate: '2024-06-05',\n                endDate: '2024-06-12',\n                purpose: 'tourism',\n                rating: 5.0,\n                title: '파리 여행',\n                description: '로맨틱한 파리'\n            },\n            {\n                id: '4',\n                country: 'KR',\n                city: '서울',\n                startDate: '2023-12-01',\n                endDate: '2023-12-05',\n                purpose: 'family',\n                rating: 4.2,\n                title: '서울 방문',\n                description: '가족 방문'\n            }\n        ];\n        \n        console.log('✅ 테스트 모듈들이 로드되었습니다.');\n    </script>\n    \n    <script>\n        // 테스트 카운터\n        let testStats = {\n            total: 0,\n            passed: 0,\n            failed: 0\n        };\n        \n        // 테스트 결과 표시 함수\n        function logTest(testName, success, details = '', errorDetails = '') {\n            const resultsDiv = document.getElementById('test-results');\n            const testDiv = document.createElement('div');\n            testDiv.className = `test-result ${success ? 'test-pass' : 'test-fail'}`;\n            \n            let content = `${success ? '✅' : '❌'} ${testName}`;\n            if (details) {\n                content += `<br><small>${details}</small>`;\n            }\n            if (errorDetails) {\n                content += `<div class=\"error-details\">${errorDetails}</div>`;\n            }\n            \n            testDiv.innerHTML = content;\n            resultsDiv.appendChild(testDiv);\n            \n            // 통계 업데이트\n            testStats.total++;\n            if (success) {\n                testStats.passed++;\n            } else {\n                testStats.failed++;\n            }\n            \n            updateTestStats();\n        }\n        \n        function logInfo(message) {\n            const resultsDiv = document.getElementById('test-results');\n            const infoDiv = document.createElement('div');\n            infoDiv.className = 'test-result test-info';\n            infoDiv.innerHTML = `ℹ️ ${message}`;\n            resultsDiv.appendChild(infoDiv);\n        }\n        \n        function updateTestStats() {\n            document.getElementById('total-tests').textContent = testStats.total;\n            document.getElementById('passed-tests').textContent = testStats.passed;\n            document.getElementById('failed-tests').textContent = testStats.failed;\n        }\n        \n        function clearResults() {\n            document.getElementById('test-results').innerHTML = '';\n            testStats = { total: 0, passed: 0, failed: 0 };\n            updateTestStats();\n        }\n        \n        // 유틸리티 테스트 함수들\n        function runUtilityTests() {\n            logInfo('📅 DateUtils 테스트 시작');\n            testDateUtils();\n            \n            logInfo('🌍 CountryUtils 테스트 시작');\n            testCountryUtils();\n            \n            logInfo('📊 StatsUtils 테스트 시작');\n            testStatsUtils();\n            \n            logInfo('✅ ValidationUtils 테스트 시작');\n            testValidationUtils();\n        }\n        \n        function testDateUtils() {\n            try {\n                const { DateUtils } = window.testModules;\n                \n                // 날짜 검증 테스트\n                logTest('DateUtils.isValidDate', \n                    DateUtils.isValidDate('2024-01-15') === true,\n                    '유효한 날짜 검증 통과');\n                \n                logTest('DateUtils.isValidDate (잘못된 날짜)', \n                    DateUtils.isValidDate('invalid-date') === false,\n                    '잘못된 날짜 검증 통과');\n                \n                // 일수 계산 테스트\n                const days = DateUtils.calculateDaysBetween('2024-01-15', '2024-01-20');\n                logTest('DateUtils.calculateDaysBetween', \n                    days === 6,\n                    `계산된 일수: ${days}일 (예상: 6일)`);\n                \n                // 연도 추출 테스트\n                const years = DateUtils.extractYearsFromLogs(window.mockTravelLogs);\n                logTest('DateUtils.extractYearsFromLogs', \n                    years.includes('2024') && years.includes('2023'),\n                    `추출된 연도: ${years.join(', ')}`);\n                \n                // 현재 연도 테스트\n                const currentYear = DateUtils.getCurrentYear();\n                logTest('DateUtils.getCurrentYear', \n                    currentYear === '2024',\n                    `현재 연도: ${currentYear}`);\n                \n            } catch (error) {\n                logTest('DateUtils 테스트', false, '', `오류: ${error.message}`);\n            }\n        }\n        \n        function testCountryUtils() {\n            try {\n                const { CountryUtils } = window.testModules;\n                \n                // 국가명 변환 테스트\n                logTest('CountryUtils.getCountryName', \n                    CountryUtils.getCountryName('JP') === '일본',\n                    'JP → 일본 변환 성공');\n                \n                logTest('CountryUtils.getCountryName (존재하지 않는 국가)', \n                    CountryUtils.getCountryName('XX') === 'XX',\n                    '존재하지 않는 국가 코드 처리 성공');\n                \n                // 대륙별 분류 테스트\n                const asianCountries = CountryUtils.getCountriesByContinent('아시아');\n                logTest('CountryUtils.getCountriesByContinent', \n                    asianCountries.length > 0 && asianCountries.includes('JP'),\n                    `아시아 국가 ${asianCountries.length}개 조회됨`);\n                \n                // 로그 필터링 테스트\n                const japanLogs = CountryUtils.filterLogsByCountry(window.mockTravelLogs, 'JP');\n                logTest('CountryUtils.filterLogsByCountry', \n                    japanLogs.length === 1 && japanLogs[0].country === 'JP',\n                    '일본 로그 1개 필터링 성공');\n                \n            } catch (error) {\n                logTest('CountryUtils 테스트', false, '', `오류: ${error.message}`);\n            }\n        }\n        \n        function testStatsUtils() {\n            try {\n                const { StatsUtils } = window.testModules;\n                \n                const testData = [1, 2, 3, 4, 5];\n                \n                // 합계 테스트\n                logTest('StatsUtils.sum', \n                    StatsUtils.sum(testData) === 15,\n                    `합계: ${StatsUtils.sum(testData)} (예상: 15)`);\n                \n                // 평균 테스트\n                logTest('StatsUtils.average', \n                    StatsUtils.average(testData, 1) === 3.0,\n                    `평균: ${StatsUtils.average(testData, 1)} (예상: 3.0)`);\n                \n                // 최대/최소값 테스트\n                logTest('StatsUtils.max', \n                    StatsUtils.max(testData) === 5,\n                    `최대값: ${StatsUtils.max(testData)} (예상: 5)`);\n                \n                logTest('StatsUtils.min', \n                    StatsUtils.min(testData) === 1,\n                    `최소값: ${StatsUtils.min(testData)} (예상: 1)`);\n                \n                // 빈도 분석 테스트\n                const frequencyData = window.mockTravelLogs;\n                const purposeFreq = StatsUtils.frequency(frequencyData, 'purpose');\n                logTest('StatsUtils.frequency', \n                    purposeFreq.length > 0 && purposeFreq[0].hasOwnProperty('value'),\n                    `목적별 빈도 분석 완료 (${purposeFreq.length}개 항목)`);\n                \n                // 증감률 테스트\n                const changeRate = StatsUtils.changeRate(100, 80, 1);\n                logTest('StatsUtils.changeRate', \n                    changeRate.type === 'increase' && changeRate.rate === 25.0,\n                    `증감률: ${changeRate.display} (유형: ${changeRate.type})`);\n                \n            } catch (error) {\n                logTest('StatsUtils 테스트', false, '', `오류: ${error.message}`);\n            }\n        }\n        \n        function testValidationUtils() {\n            try {\n                const { ValidationUtils } = window.testModules;\n                \n                // 로그 검증 테스트\n                const validLog = {\n                    country: 'JP',\n                    city: '도쿄',\n                    startDate: '2024-01-15',\n                    endDate: '2024-01-20',\n                    purpose: 'tourism',\n                    rating: 4.5\n                };\n                \n                const validation = ValidationUtils.validateTravelLog(validLog);\n                logTest('ValidationUtils.validateTravelLog (유효한 로그)', \n                    validation.isValid === true,\n                    `검증 결과: ${validation.isValid ? '유효함' : '무효함'}`);\n                \n                // 무효한 로그 테스트\n                const invalidLog = {\n                    country: '',\n                    city: '',\n                    startDate: 'invalid-date',\n                    endDate: '2024-01-15',\n                    purpose: 'invalid-purpose',\n                    rating: 10\n                };\n                \n                const invalidValidation = ValidationUtils.validateTravelLog(invalidLog);\n                logTest('ValidationUtils.validateTravelLog (무효한 로그)', \n                    invalidValidation.isValid === false && invalidValidation.errors.length > 0,\n                    `검증 오류 ${invalidValidation.errors.length}개 감지됨`);\n                \n                // 필수 필드 검증 테스트\n                logTest('ValidationUtils.isRequired', \n                    ValidationUtils.isRequired('테스트') === true && ValidationUtils.isRequired('') === false,\n                    '필수 필드 검증 통과');\n                \n                // 날짜 범위 검증 테스트\n                logTest('ValidationUtils.isDateInRange', \n                    ValidationUtils.isDateInRange('2024-01-15') === true,\n                    '날짜 범위 검증 통과');\n                \n            } catch (error) {\n                logTest('ValidationUtils 테스트', false, '', `오류: ${error.message}`);\n            }\n        }\n        \n        // 서비스 테스트 함수들\n        function runServiceTests() {\n            logInfo('🔧 서비스 통합 테스트 시작');\n            testServiceIntegration();\n        }\n        \n        function testServiceIntegration() {\n            try {\n                const { \n                    LogDataService, \n                    CacheManager, \n                    BasicStatsService, \n                    CountryAnalysisService, \n                    PurposeAnalysisService,\n                    YearlyStatsService \n                } = window.testModules;\n                \n                // Mock Storage Manager\n                const mockStorageManager = {\n                    getAllLogs: () => window.mockTravelLogs,\n                    saveLogs: (logs) => true,\n                    addLog: (log) => true,\n                    deleteLog: (id) => true,\n                    updateLog: (id, log) => true\n                };\n                \n                // 서비스 인스턴스 생성\n                const cacheManager = new CacheManager();\n                const logDataService = new LogDataService(mockStorageManager);\n                const basicStatsService = new BasicStatsService(logDataService, cacheManager);\n                const countryAnalysisService = new CountryAnalysisService(logDataService, cacheManager);\n                const purposeAnalysisService = new PurposeAnalysisService(logDataService, cacheManager);\n                const yearlyStatsService = new YearlyStatsService(logDataService, cacheManager);\n                \n                // 데이터 로드 테스트\n                logDataService.setLogs(window.mockTravelLogs);\n                const loadedLogs = logDataService.getAllLogs();\n                logTest('LogDataService.getAllLogs', \n                    loadedLogs.length === 4,\n                    `로그 ${loadedLogs.length}개 로드됨`);\n                \n                // 기본 통계 서비스 테스트\n                const basicStats = basicStatsService.getBasicStats();\n                logTest('BasicStatsService.getBasicStats', \n                    basicStats.hasData === true && basicStats.totalLogs === 4,\n                    `기본 통계: 총 ${basicStats.totalLogs}개 로그, ${basicStats.visitedCountries}개 국가`);\n                \n                // 국가 분석 서비스 테스트\n                const countryAnalysis = countryAnalysisService.getFavoriteCountryAnalysis();\n                logTest('CountryAnalysisService.getFavoriteCountryAnalysis', \n                    countryAnalysis.hasData === true && countryAnalysis.topCountry,\n                    `주요방문국: ${countryAnalysis.topCountry?.country || 'N/A'}`);\n                \n                // 목적 분석 서비스 테스트\n                const purposeAnalysis = purposeAnalysisService.getPurposeAnalysis();\n                logTest('PurposeAnalysisService.getPurposeAnalysis', \n                    purposeAnalysis.hasData === true && purposeAnalysis.purposeBreakdown.length > 0,\n                    `목적 분석: ${purposeAnalysis.purposeBreakdown.length}개 항목`);\n                \n                // 연도별 통계 서비스 테스트\n                const yearlyStats = yearlyStatsService.getYearlyStatsAnalysis('2024');\n                logTest('YearlyStatsService.getYearlyStatsAnalysis', \n                    yearlyStats.hasData === true,\n                    `2024년 통계: ${yearlyStats.currentYear?.totalTrips || 0}회 여행`);\n                \n                // 캐시 매니저 테스트\n                cacheManager.set('test-key', { test: 'data' }, 'hash123');\n                const cachedData = cacheManager.get('test-key', 'hash123');\n                logTest('CacheManager 기능', \n                    cachedData && cachedData.test === 'data',\n                    '캐시 저장/조회 성공');\n                \n            } catch (error) {\n                logTest('서비스 통합 테스트', false, '', `오류: ${error.message}`);\n            }\n        }\n        \n        // 성능 테스트 함수들\n        function runPerformanceTests() {\n            logInfo('⚡ 성능 테스트 시작');\n            testPerformance();\n        }\n        \n        function testPerformance() {\n            try {\n                const { StatsUtils, DateUtils, CountryUtils } = window.testModules;\n                \n                // 대용량 데이터 생성 (1000개 로그)\n                const largeMockData = [];\n                for (let i = 0; i < 1000; i++) {\n                    largeMockData.push({\n                        id: `log-${i}`,\n                        country: ['JP', 'US', 'FR', 'KR', 'DE'][i % 5],\n                        city: `City${i}`,\n                        startDate: `2024-${String(Math.floor(i/100) + 1).padStart(2, '0')}-${String((i % 28) + 1).padStart(2, '0')}`,\n                        endDate: `2024-${String(Math.floor(i/100) + 1).padStart(2, '0')}-${String((i % 28) + 5).padStart(2, '0')}`,\n                        purpose: ['tourism', 'business', 'family'][i % 3],\n                        rating: Math.random() * 5\n                    });\n                }\n                \n                // 성능 측정: StatsUtils\n                const start1 = performance.now();\n                for (let i = 0; i < 100; i++) {\n                    StatsUtils.frequency(largeMockData, 'purpose');\n                }\n                const end1 = performance.now();\n                logTest('StatsUtils 성능 테스트', \n                    (end1 - start1) < 1000,\n                    `빈도 분석 100회 실행: ${(end1 - start1).toFixed(2)}ms`);\n                \n                // 성능 측정: DateUtils\n                const start2 = performance.now();\n                for (let i = 0; i < 1000; i++) {\n                    DateUtils.filterLogsByYear(largeMockData, '2024');\n                }\n                const end2 = performance.now();\n                logTest('DateUtils 성능 테스트', \n                    (end2 - start2) < 2000,\n                    `연도별 필터링 1000회 실행: ${(end2 - start2).toFixed(2)}ms`);\n                \n                // 성능 측정: CountryUtils\n                const start3 = performance.now();\n                for (let i = 0; i < 1000; i++) {\n                    CountryUtils.filterLogsByCountry(largeMockData, 'JP');\n                }\n                const end3 = performance.now();\n                logTest('CountryUtils 성능 테스트', \n                    (end3 - start3) < 2000,\n                    `국가별 필터링 1000회 실행: ${(end3 - start3).toFixed(2)}ms`);\n                \n                // 메모리 사용량 체크 (근사치)\n                const memoryInfo = performance.memory || {};\n                logTest('메모리 사용량 체크', \n                    true,\n                    `사용 메모리: ${(memoryInfo.usedJSHeapSize / 1024 / 1024).toFixed(2)}MB`);\n                \n            } catch (error) {\n                logTest('성능 테스트', false, '', `오류: ${error.message}`);\n            }\n        }\n        \n        // 전체 테스트 실행\n        function runAllTests() {\n            clearResults();\n            logInfo('🚀 전체 테스트 시작');\n            \n            runUtilityTests();\n            runServiceTests();\n            runPerformanceTests();\n            \n            logInfo('✨ 전체 테스트 완료');\n        }\n        \n        // 페이지 로드 시 자동 실행\n        window.addEventListener('load', () => {\n            setTimeout(() => {\n                logInfo('🎯 TravelLog Phase 4 통합 테스트가 준비되었습니다.');\n                logInfo('상단의 버튼을 클릭하여 테스트를 실행하세요.');\n            }, 1000);\n        });\n    </script>\n</body>\n</html>"
