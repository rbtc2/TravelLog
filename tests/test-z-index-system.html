<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Z-Index 시스템 테스트 - TravelLog</title>
    <link rel="stylesheet" href="../styles/main.css">
    <style>
        /* 테스트용 스타일 */
        .test-container {
            padding: 20px;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .test-section {
            margin: 40px 0;
            padding: 20px;
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            background: #f8f9fa;
        }
        
        .test-title {
            font-size: 24px;
            font-weight: bold;
            color: #2d3748;
            margin-bottom: 20px;
        }
        
        .test-description {
            font-size: 16px;
            color: #4a5568;
            margin-bottom: 20px;
            line-height: 1.6;
        }
        
        .test-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .test-btn {
            padding: 10px 20px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s ease;
        }
        
        .test-btn:hover {
            background: #5a67d8;
            transform: translateY(-2px);
        }
        
        .test-btn.danger {
            background: #e53e3e;
        }
        
        .test-btn.danger:hover {
            background: #c53030;
        }
        
        .test-btn.success {
            background: #48bb78;
        }
        
        .test-btn.success:hover {
            background: #38a169;
        }
        
        .test-result {
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            font-family: monospace;
            font-size: 14px;
        }
        
        .test-result.success {
            background: #f0fff4;
            border: 1px solid #9ae6b4;
            color: #22543d;
        }
        
        .test-result.error {
            background: #fed7d7;
            border: 1px solid #feb2b2;
            color: #742a2a;
        }
        
        .test-result.info {
            background: #ebf8ff;
            border: 1px solid #90cdf4;
            color: #2a4365;
        }
        
        /* 테스트용 모달 */
        .test-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: var(--z-modal);
        }
        
        .test-modal.open {
            display: flex;
        }
        
        .test-modal-content {
            background: white;
            padding: 30px;
            border-radius: 12px;
            max-width: 500px;
            width: 90%;
            position: relative;
        }
        
        .test-modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #718096;
        }
        
        /* 테스트용 드롭다운 */
        .test-dropdown {
            position: relative;
            display: inline-block;
            margin: 10px;
        }
        
        .test-dropdown-btn {
            padding: 10px 20px;
            background: #48bb78;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
        }
        
        .test-dropdown-content {
            position: absolute;
            top: 100%;
            left: 0;
            background: white;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            padding: 10px;
            min-width: 200px;
            display: none;
            z-index: var(--z-dropdown);
        }
        
        .test-dropdown.open .test-dropdown-content {
            display: block;
        }
        
        /* 테스트용 툴팁 */
        .test-tooltip {
            position: relative;
            display: inline-block;
            margin: 10px;
        }
        
        .test-tooltip-btn {
            padding: 10px 20px;
            background: #f59e0b;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
        }
        
        .test-tooltip-content {
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: #2d3748;
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 14px;
            white-space: nowrap;
            display: none;
            z-index: var(--z-tooltip);
        }
        
        .test-tooltip-content::after {
            content: '';
            position: absolute;
            top: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 5px solid transparent;
            border-top-color: #2d3748;
        }
        
        .test-tooltip.visible .test-tooltip-content {
            display: block;
        }
        
        /* Country Selector 테스트 */
        .country-selector-test {
            margin: 20px 0;
            padding: 20px;
            border: 2px solid #667eea;
            border-radius: 12px;
            background: rgba(102, 126, 234, 0.05);
        }
        
        .country-selector-test h3 {
            color: #667eea;
            margin-bottom: 15px;
        }
        
        /* 디버그 모드 스타일 */
        .debug-z-index .country-selector,
        .debug-z-index .country-selector-v2 {
            outline: 3px solid #ff0000 !important;
            outline-offset: 3px !important;
        }
        
        .debug-z-index .modal {
            outline: 3px solid #0000ff !important;
            outline-offset: 3px !important;
        }
        
        .debug-z-index .dropdown {
            outline: 3px solid #ffff00 !important;
            outline-offset: 3px !important;
        }
        
        .debug-z-index .tooltip {
            outline: 3px solid #00ff00 !important;
            outline-offset: 3px !important;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>🔧 Z-Index 시스템 종합 테스트</h1>
        <p>Country Selector의 z-index 오버레이 문제 해결을 위한 종합 테스트 페이지입니다.</p>
        
        <!-- 테스트 1: 기본 Country Selector 테스트 -->
        <div class="test-section">
            <div class="test-title">테스트 1: 기본 Country Selector 기능</div>
            <div class="test-description">
                Country Selector가 정상적으로 작동하는지 확인합니다.
            </div>
            <div class="test-controls">
                <button class="test-btn" onclick="testCountrySelector()">Country Selector 테스트</button>
                <button class="test-btn" onclick="testCountrySelectorV2()">Country Selector V2 테스트</button>
            </div>
            <div class="country-selector-test">
                <h3>Country Selector (기존 버전)</h3>
                <div class="country-selector" id="country-selector-1">
                    <div class="selector-input">
                        <input type="text" placeholder="국가를 검색하세요..." id="country-input-1">
                        <button class="dropdown-arrow" onclick="toggleDropdown('country-selector-1')">
                            <span class="arrow-icon">▼</span>
                        </button>
                    </div>
                    <div class="selector-dropdown" id="dropdown-1">
                        <div class="section-title">인기 국가</div>
                        <div class="countries-list">
                            <div class="country-item">
                                <span class="country-flag">🇰🇷</span>
                                <span class="country-name">대한민국</span>
                                <span class="country-name-en">South Korea</span>
                                <span class="country-continent">ASIA</span>
                            </div>
                            <div class="country-item">
                                <span class="country-flag">🇯🇵</span>
                                <span class="country-name">일본</span>
                                <span class="country-name-en">Japan</span>
                                <span class="country-continent">ASIA</span>
                            </div>
                            <div class="country-item">
                                <span class="country-flag">🇺🇸</span>
                                <span class="country-name">미국</span>
                                <span class="country-name-en">United States</span>
                                <span class="country-continent">NORTH AMERICA</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="country-selector-test">
                <h3>Country Selector V2 (새 버전)</h3>
                <div class="country-selector-v2" id="country-selector-2">
                    <div class="selector-input-container">
                        <input type="text" class="selector-input" placeholder="국가를 검색하세요..." id="country-input-2">
                        <button class="dropdown-arrow" onclick="toggleDropdownV2('country-selector-2')">
                            <span class="arrow-icon">▼</span>
                        </button>
                    </div>
                    <div class="selector-dropdown" id="dropdown-2">
                        <div class="section-title">인기 국가</div>
                        <div class="countries-list">
                            <div class="country-item">
                                <span class="country-flag">🇰🇷</span>
                                <span class="country-name">대한민국</span>
                                <span class="country-name-en">South Korea</span>
                                <span class="country-continent">ASIA</span>
                            </div>
                            <div class="country-item">
                                <span class="country-flag">🇯🇵</span>
                                <span class="country-name">일본</span>
                                <span class="country-name-en">Japan</span>
                                <span class="country-continent">ASIA</span>
                            </div>
                            <div class="country-item">
                                <span class="country-flag">🇺🇸</span>
                                <span class="country-name">미국</span>
                                <span class="country-name-en">United States</span>
                                <span class="country-continent">NORTH AMERICA</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="test-result-1" class="test-result" style="display: none;"></div>
        </div>
        
        <!-- 테스트 2: 모달과의 충돌 테스트 -->
        <div class="test-section">
            <div class="test-title">테스트 2: 모달과의 충돌 해결</div>
            <div class="test-description">
                Country Selector가 모달과 함께 사용될 때 충돌이 해결되는지 확인합니다.
            </div>
            <div class="test-controls">
                <button class="test-btn" onclick="openTestModal()">모달 열기</button>
                <button class="test-btn danger" onclick="closeTestModal()">모달 닫기</button>
                <button class="test-btn" onclick="testModalConflict()">충돌 테스트</button>
            </div>
            <div class="test-modal" id="test-modal">
                <div class="test-modal-content">
                    <button class="test-modal-close" onclick="closeTestModal()">×</button>
                    <h3>테스트 모달</h3>
                    <p>이 모달이 Country Selector와 충돌하는지 확인합니다.</p>
                    <div class="country-selector-test">
                        <h4>모달 내부 Country Selector</h4>
                        <div class="country-selector-v2" id="modal-country-selector">
                            <div class="selector-input-container">
                                <input type="text" class="selector-input" placeholder="국가를 검색하세요...">
                                <button class="dropdown-arrow" onclick="toggleDropdownV2('modal-country-selector')">
                                    <span class="arrow-icon">▼</span>
                                </button>
                            </div>
                            <div class="selector-dropdown">
                                <div class="section-title">인기 국가</div>
                                <div class="countries-list">
                                    <div class="country-item">
                                        <span class="country-flag">🇰🇷</span>
                                        <span class="country-name">대한민국</span>
                                        <span class="country-name-en">South Korea</span>
                                        <span class="country-continent">ASIA</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div id="test-result-2" class="test-result" style="display: none;"></div>
        </div>
        
        <!-- 테스트 3: 다중 드롭다운 충돌 테스트 -->
        <div class="test-section">
            <div class="test-title">테스트 3: 다중 드롭다운 충돌 해결</div>
            <div class="test-description">
                여러 드롭다운이 동시에 열렸을 때 Country Selector가 최우선으로 표시되는지 확인합니다.
            </div>
            <div class="test-controls">
                <button class="test-btn" onclick="openAllDropdowns()">모든 드롭다운 열기</button>
                <button class="test-btn danger" onclick="closeAllDropdowns()">모든 드롭다운 닫기</button>
                <button class="test-btn" onclick="testMultipleDropdowns()">다중 충돌 테스트</button>
            </div>
            <div class="test-dropdown">
                <button class="test-dropdown-btn" onclick="toggleTestDropdown('dropdown-1')">일반 드롭다운 1</button>
                <div class="test-dropdown-content" id="dropdown-1">
                    <div>드롭다운 항목 1</div>
                    <div>드롭다운 항목 2</div>
                    <div>드롭다운 항목 3</div>
                </div>
            </div>
            <div class="test-dropdown">
                <button class="test-dropdown-btn" onclick="toggleTestDropdown('dropdown-2')">일반 드롭다운 2</button>
                <div class="test-dropdown-content" id="dropdown-2">
                    <div>드롭다운 항목 A</div>
                    <div>드롭다운 항목 B</div>
                    <div>드롭다운 항목 C</div>
                </div>
            </div>
            <div id="test-result-3" class="test-result" style="display: none;"></div>
        </div>
        
        <!-- 테스트 4: 툴팁과의 충돌 테스트 -->
        <div class="test-section">
            <div class="test-title">테스트 4: 툴팁과의 충돌 해결</div>
            <div class="test-description">
                Country Selector가 툴팁과 함께 사용될 때 충돌이 해결되는지 확인합니다.
            </div>
            <div class="test-controls">
                <button class="test-btn" onclick="showAllTooltips()">모든 툴팁 표시</button>
                <button class="test-btn danger" onclick="hideAllTooltips()">모든 툴팁 숨김</button>
                <button class="test-btn" onclick="testTooltipConflict()">툴팁 충돌 테스트</button>
            </div>
            <div class="test-tooltip" id="tooltip-1">
                <button class="test-tooltip-btn" onclick="toggleTooltip('tooltip-1')">툴팁 1</button>
                <div class="test-tooltip-content">이것은 툴팁 1입니다.</div>
            </div>
            <div class="test-tooltip" id="tooltip-2">
                <button class="test-tooltip-btn" onclick="toggleTooltip('tooltip-2')">툴팁 2</button>
                <div class="test-tooltip-content">이것은 툴팁 2입니다.</div>
            </div>
            <div id="test-result-4" class="test-result" style="display: none;"></div>
        </div>
        
        <!-- 테스트 5: 모바일 환경 테스트 -->
        <div class="test-section">
            <div class="test-title">테스트 5: 모바일 환경 폴백</div>
            <div class="test-description">
                모바일 환경에서 Country Selector가 fullscreen 모달로 전환되는지 확인합니다.
            </div>
            <div class="test-controls">
                <button class="test-btn" onclick="simulateMobile()">모바일 시뮬레이션</button>
                <button class="test-btn" onclick="simulateDesktop()">데스크톱 시뮬레이션</button>
                <button class="test-btn" onclick="testMobileFallback()">모바일 폴백 테스트</button>
            </div>
            <div id="test-result-5" class="test-result" style="display: none;"></div>
        </div>
        
        <!-- 테스트 6: 디버그 모드 테스트 -->
        <div class="test-section">
            <div class="test-title">테스트 6: 디버그 모드</div>
            <div class="test-description">
                Z-Index 디버그 모드를 통해 충돌 상황을 시각적으로 확인합니다.
            </div>
            <div class="test-controls">
                <button class="test-btn" onclick="enableDebugMode()">디버그 모드 활성화</button>
                <button class="test-btn danger" onclick="disableDebugMode()">디버그 모드 비활성화</button>
                <button class="test-btn" onclick="showZIndexInfo()">Z-Index 정보 표시</button>
            </div>
            <div id="test-result-6" class="test-result" style="display: none;"></div>
        </div>
        
        <!-- 테스트 7: 성능 테스트 -->
        <div class="test-section">
            <div class="test-title">테스트 7: 성능 테스트</div>
            <div class="test-description">
                Z-Index 시스템의 성능을 측정합니다.
            </div>
            <div class="test-controls">
                <button class="test-btn" onclick="testPerformance()">성능 테스트</button>
                <button class="test-btn" onclick="testMemoryUsage()">메모리 사용량 테스트</button>
                <button class="test-btn" onclick="testConflictDetectionSpeed()">충돌 감지 속도 테스트</button>
            </div>
            <div id="test-result-7" class="test-result" style="display: none;"></div>
        </div>
    </div>
    
    <script type="module">
        // Z-Index Manager 초기화
        import ZIndexManager from '../js/modules/utils/z-index-manager.js';
        
        // 전역 변수
        let zIndexManager;
        let testResults = {};
        
        // 초기화
        document.addEventListener('DOMContentLoaded', async () => {
            try {
                zIndexManager = window.zIndexManager;
                console.log('Z-Index Manager 초기화 완료');
                
                // 테스트 결과 초기화
                testResults = {
                    countrySelector: false,
                    modalConflict: false,
                    multipleDropdowns: false,
                    tooltipConflict: false,
                    mobileFallback: false,
                    debugMode: false,
                    performance: false
                };
                
            } catch (error) {
                console.error('Z-Index Manager 초기화 실패:', error);
            }
        });
        
        // Country Selector 테스트
        window.testCountrySelector = function() {
            const selector = document.getElementById('country-selector-1');
            const result = document.getElementById('test-result-1');
            
            try {
                // 드롭다운 열기
                selector.classList.add('open');
                
                // z-index 확인
                const computedStyle = window.getComputedStyle(selector);
                const zIndex = computedStyle.zIndex;
                
                if (zIndex && parseInt(zIndex) > 0) {
                    testResults.countrySelector = true;
                    showTestResult(result, 'success', `✅ Country Selector 정상 작동 (z-index: ${zIndex})`);
                } else {
                    showTestResult(result, 'error', '❌ Country Selector z-index 문제');
                }
                
            } catch (error) {
                showTestResult(result, 'error', `❌ Country Selector 테스트 실패: ${error.message}`);
            }
        };
        
        // Country Selector V2 테스트
        window.testCountrySelectorV2 = function() {
            const selector = document.getElementById('country-selector-2');
            const result = document.getElementById('test-result-1');
            
            try {
                // 드롭다운 열기
                selector.classList.add('open');
                
                // z-index 확인
                const computedStyle = window.getComputedStyle(selector);
                const zIndex = computedStyle.zIndex;
                
                if (zIndex && parseInt(zIndex) > 0) {
                    testResults.countrySelector = true;
                    showTestResult(result, 'success', `✅ Country Selector V2 정상 작동 (z-index: ${zIndex})`);
                } else {
                    showTestResult(result, 'error', '❌ Country Selector V2 z-index 문제');
                }
                
            } catch (error) {
                showTestResult(result, 'error', `❌ Country Selector V2 테스트 실패: ${error.message}`);
            }
        };
        
        // 드롭다운 토글 함수들
        window.toggleDropdown = function(selectorId) {
            const selector = document.getElementById(selectorId);
            const dropdown = document.getElementById('dropdown-1');
            
            selector.classList.toggle('open');
            dropdown.classList.toggle('open');
        };
        
        window.toggleDropdownV2 = function(selectorId) {
            const selector = document.getElementById(selectorId);
            const dropdown = selector.querySelector('.selector-dropdown');
            
            selector.classList.toggle('open');
            dropdown.classList.toggle('open');
        };
        
        // 모달 테스트
        window.openTestModal = function() {
            const modal = document.getElementById('test-modal');
            modal.classList.add('open');
        };
        
        window.closeTestModal = function() {
            const modal = document.getElementById('test-modal');
            modal.classList.remove('open');
        };
        
        window.testModalConflict = function() {
            const result = document.getElementById('test-result-2');
            
            try {
                // 모달 열기
                openTestModal();
                
                // Country Selector 열기
                const selector = document.getElementById('modal-country-selector');
                selector.classList.add('open');
                
                // 충돌 확인
                setTimeout(() => {
                    const selectorZIndex = window.getComputedStyle(selector).zIndex;
                    const modalZIndex = window.getComputedStyle(document.getElementById('test-modal')).zIndex;
                    
                    if (parseInt(selectorZIndex) > parseInt(modalZIndex)) {
                        testResults.modalConflict = true;
                        showTestResult(result, 'success', '✅ 모달과의 충돌 해결됨');
                    } else {
                        showTestResult(result, 'error', '❌ 모달과의 충돌 해결 실패');
                    }
                }, 100);
                
            } catch (error) {
                showTestResult(result, 'error', `❌ 모달 충돌 테스트 실패: ${error.message}`);
            }
        };
        
        // 다중 드롭다운 테스트
        window.toggleTestDropdown = function(dropdownId) {
            const dropdown = document.getElementById(dropdownId);
            dropdown.parentElement.classList.toggle('open');
        };
        
        window.openAllDropdowns = function() {
            document.querySelectorAll('.test-dropdown').forEach(dropdown => {
                dropdown.classList.add('open');
            });
        };
        
        window.closeAllDropdowns = function() {
            document.querySelectorAll('.test-dropdown').forEach(dropdown => {
                dropdown.classList.remove('open');
            });
        };
        
        window.testMultipleDropdowns = function() {
            const result = document.getElementById('test-result-3');
            
            try {
                // 모든 드롭다운 열기
                openAllDropdowns();
                
                // Country Selector 열기
                const selector = document.getElementById('country-selector-2');
                selector.classList.add('open');
                
                // 충돌 확인
                setTimeout(() => {
                    const selectorZIndex = parseInt(window.getComputedStyle(selector).zIndex);
                    const dropdownZIndexes = Array.from(document.querySelectorAll('.test-dropdown-content'))
                        .map(dropdown => parseInt(window.getComputedStyle(dropdown).zIndex));
                    
                    const maxDropdownZIndex = Math.max(...dropdownZIndexes);
                    
                    if (selectorZIndex > maxDropdownZIndex) {
                        testResults.multipleDropdowns = true;
                        showTestResult(result, 'success', '✅ 다중 드롭다운 충돌 해결됨');
                    } else {
                        showTestResult(result, 'error', '❌ 다중 드롭다운 충돌 해결 실패');
                    }
                }, 100);
                
            } catch (error) {
                showTestResult(result, 'error', `❌ 다중 드롭다운 테스트 실패: ${error.message}`);
            }
        };
        
        // 툴팁 테스트
        window.toggleTooltip = function(tooltipId) {
            const tooltip = document.getElementById(tooltipId);
            tooltip.classList.toggle('visible');
        };
        
        window.showAllTooltips = function() {
            document.querySelectorAll('.test-tooltip').forEach(tooltip => {
                tooltip.classList.add('visible');
            });
        };
        
        window.hideAllTooltips = function() {
            document.querySelectorAll('.test-tooltip').forEach(tooltip => {
                tooltip.classList.remove('visible');
            });
        };
        
        window.testTooltipConflict = function() {
            const result = document.getElementById('test-result-4');
            
            try {
                // 모든 툴팁 표시
                showAllTooltips();
                
                // Country Selector 열기
                const selector = document.getElementById('country-selector-2');
                selector.classList.add('open');
                
                // 충돌 확인
                setTimeout(() => {
                    const selectorZIndex = parseInt(window.getComputedStyle(selector).zIndex);
                    const tooltipZIndexes = Array.from(document.querySelectorAll('.test-tooltip-content'))
                        .map(tooltip => parseInt(window.getComputedStyle(tooltip).zIndex));
                    
                    const maxTooltipZIndex = Math.max(...tooltipZIndexes);
                    
                    if (selectorZIndex > maxTooltipZIndex) {
                        testResults.tooltipConflict = true;
                        showTestResult(result, 'success', '✅ 툴팁과의 충돌 해결됨');
                    } else {
                        showTestResult(result, 'error', '❌ 툴팁과의 충돌 해결 실패');
                    }
                }, 100);
                
            } catch (error) {
                showTestResult(result, 'error', `❌ 툴팁 충돌 테스트 실패: ${error.message}`);
            }
        };
        
        // 모바일 테스트
        window.simulateMobile = function() {
            document.body.style.width = '375px';
            document.body.style.height = '667px';
            document.body.style.border = '2px solid #ccc';
        };
        
        window.simulateDesktop = function() {
            document.body.style.width = '100%';
            document.body.style.height = '100%';
            document.body.style.border = 'none';
        };
        
        window.testMobileFallback = function() {
            const result = document.getElementById('test-result-5');
            
            try {
                // 모바일 시뮬레이션
                simulateMobile();
                
                // Country Selector 열기
                const selector = document.getElementById('country-selector-2');
                selector.classList.add('open');
                
                // 폴백 모드 확인
                setTimeout(() => {
                    if (selector.classList.contains('mobile-fallback')) {
                        testResults.mobileFallback = true;
                        showTestResult(result, 'success', '✅ 모바일 폴백 모드 활성화됨');
                    } else {
                        showTestResult(result, 'info', 'ℹ️ 모바일 폴백 모드가 활성화되지 않음 (정상일 수 있음)');
                    }
                }, 100);
                
            } catch (error) {
                showTestResult(result, 'error', `❌ 모바일 폴백 테스트 실패: ${error.message}`);
            }
        };
        
        // 디버그 모드 테스트
        window.enableDebugMode = function() {
            if (zIndexManager) {
                zIndexManager.setDebugMode(true);
                document.body.classList.add('debug-z-index');
                showTestResult(document.getElementById('test-result-6'), 'info', '🔍 디버그 모드 활성화됨');
            }
        };
        
        window.disableDebugMode = function() {
            if (zIndexManager) {
                zIndexManager.setDebugMode(false);
                document.body.classList.remove('debug-z-index');
                showTestResult(document.getElementById('test-result-6'), 'info', '🔍 디버그 모드 비활성화됨');
            }
        };
        
        window.showZIndexInfo = function() {
            const result = document.getElementById('test-result-6');
            
            if (zIndexManager) {
                const watchedElements = zIndexManager.getWatchedElements();
                const activeElements = zIndexManager.getActiveElements();
                const conflictHistory = zIndexManager.getConflictHistory();
                
                let info = `📊 Z-Index 정보:\n`;
                info += `- 감시 중인 요소: ${watchedElements.size}개\n`;
                info += `- 활성화된 요소: ${activeElements.size}개\n`;
                info += `- 충돌 해결 기록: ${conflictHistory.length}개\n\n`;
                
                info += `🎯 CSS 변수 값:\n`;
                const root = document.documentElement;
                const cssVars = [
                    '--z-country-selector',
                    '--z-country-dropdown',
                    '--z-modal',
                    '--z-dropdown',
                    '--z-tooltip'
                ];
                
                cssVars.forEach(varName => {
                    const value = getComputedStyle(root).getPropertyValue(varName);
                    info += `- ${varName}: ${value}\n`;
                });
                
                showTestResult(result, 'info', info);
            } else {
                showTestResult(result, 'error', '❌ Z-Index Manager가 초기화되지 않음');
            }
        };
        
        // 성능 테스트
        window.testPerformance = function() {
            const result = document.getElementById('test-result-7');
            
            try {
                const startTime = performance.now();
                
                // 1000번의 z-index 계산
                for (let i = 0; i < 1000; i++) {
                    const selector = document.getElementById('country-selector-2');
                    const zIndex = window.getComputedStyle(selector).zIndex;
                }
                
                const endTime = performance.now();
                const duration = endTime - startTime;
                
                if (duration < 100) {
                    testResults.performance = true;
                    showTestResult(result, 'success', `✅ 성능 테스트 통과 (${duration.toFixed(2)}ms)`);
                } else {
                    showTestResult(result, 'error', `❌ 성능 테스트 실패 (${duration.toFixed(2)}ms)`);
                }
                
            } catch (error) {
                showTestResult(result, 'error', `❌ 성능 테스트 실패: ${error.message}`);
            }
        };
        
        window.testMemoryUsage = function() {
            const result = document.getElementById('test-result-7');
            
            try {
                if (performance.memory) {
                    const memory = {
                        used: Math.round(performance.memory.usedJSHeapSize / 1024 / 1024),
                        total: Math.round(performance.memory.totalJSHeapSize / 1024 / 1024)
                    };
                    
                    showTestResult(result, 'info', `💾 메모리 사용량: ${memory.used}MB / ${memory.total}MB`);
                } else {
                    showTestResult(result, 'info', 'ℹ️ 메모리 정보를 사용할 수 없습니다.');
                }
                
            } catch (error) {
                showTestResult(result, 'error', `❌ 메모리 테스트 실패: ${error.message}`);
            }
        };
        
        window.testConflictDetectionSpeed = function() {
            const result = document.getElementById('test-result-7');
            
            try {
                if (zIndexManager) {
                    const startTime = performance.now();
                    
                    // 충돌 감지 실행
                    zIndexManager.detectConflicts();
                    
                    const endTime = performance.now();
                    const duration = endTime - startTime;
                    
                    if (duration < 50) {
                        showTestResult(result, 'success', `✅ 충돌 감지 속도 양호 (${duration.toFixed(2)}ms)`);
                    } else {
                        showTestResult(result, 'error', `❌ 충돌 감지 속도 느림 (${duration.toFixed(2)}ms)`);
                    }
                } else {
                    showTestResult(result, 'error', '❌ Z-Index Manager가 초기화되지 않음');
                }
                
            } catch (error) {
                showTestResult(result, 'error', `❌ 충돌 감지 속도 테스트 실패: ${error.message}`);
            }
        };
        
        // 테스트 결과 표시 함수
        function showTestResult(element, type, message) {
            element.style.display = 'block';
            element.className = `test-result ${type}`;
            element.textContent = message;
        }
        
        // 전체 테스트 실행
        window.runAllTests = function() {
            console.log('전체 테스트 시작...');
            
            // 모든 테스트 순차 실행
            setTimeout(() => testCountrySelector(), 100);
            setTimeout(() => testCountrySelectorV2(), 200);
            setTimeout(() => testModalConflict(), 300);
            setTimeout(() => testMultipleDropdowns(), 400);
            setTimeout(() => testTooltipConflict(), 500);
            setTimeout(() => testMobileFallback(), 600);
            setTimeout(() => testPerformance(), 700);
            
            // 결과 요약
            setTimeout(() => {
                const passedTests = Object.values(testResults).filter(result => result).length;
                const totalTests = Object.keys(testResults).length;
                
                console.log(`테스트 완료: ${passedTests}/${totalTests} 통과`);
                
                if (passedTests === totalTests) {
                    alert('🎉 모든 테스트 통과! Z-Index 시스템이 정상적으로 작동합니다.');
                } else {
                    alert(`⚠️ ${passedTests}/${totalTests} 테스트 통과. 일부 문제가 있을 수 있습니다.`);
                }
            }, 1000);
        };
        
        // 페이지 로드 시 자동 테스트 실행 옵션
        // window.runAllTests();
    </script>
</body>
</html>
