<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>날짜 수정 UX 테스트</title>
    <link rel="stylesheet" href="styles/main.css">
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .test-container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            padding: 24px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        
        .test-title {
            color: #1a202c;
            margin-bottom: 24px;
            font-size: 24px;
            font-weight: 600;
        }
        
        .test-scenario {
            background: #f7fafc;
            border: 1px solid #e2e8f0;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 16px;
        }
        
        .scenario-title {
            color: #2d3748;
            font-weight: 600;
            margin-bottom: 8px;
        }
        
        .scenario-description {
            color: #4a5568;
            font-size: 14px;
            margin-bottom: 12px;
        }
        
        .test-button {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: background-color 0.2s;
        }
        
        .test-button:hover {
            background: #5a67d8;
        }
        
        .test-results {
            margin-top: 24px;
            padding: 16px;
            background: #edf2f7;
            border-radius: 8px;
            border-left: 4px solid #667eea;
        }
        
        .result-item {
            margin-bottom: 8px;
            padding: 8px;
            background: white;
            border-radius: 4px;
            font-size: 14px;
        }
        
        .result-success {
            color: #38a169;
        }
        
        .result-error {
            color: #e53e3e;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1 class="test-title">🎯 날짜 수정 UX 개선 테스트</h1>
        
        <div class="test-scenario">
            <div class="scenario-title">📋 테스트 시나리오 1: 시작일 먼저 변경</div>
            <div class="scenario-description">
                시작일을 종료일보다 늦은 날짜로 먼저 변경해보세요. 
                이제 제약 없이 자유롭게 입력할 수 있어야 합니다.
            </div>
            <button class="test-button" onclick="testScenario1()">테스트 시작</button>
        </div>
        
        <div class="test-scenario">
            <div class="scenario-title">📋 테스트 시나리오 2: 종료일 먼저 변경</div>
            <div class="scenario-description">
                종료일을 시작일보다 이른 날짜로 먼저 변경해보세요.
                포커스 아웃 시 지능적 조정 제안이 나타나야 합니다.
            </div>
            <button class="test-button" onclick="testScenario2()">테스트 시작</button>
        </div>
        
        <div class="test-scenario">
            <div class="scenario-title">📋 테스트 시나리오 3: 빠른 연속 변경</div>
            <div class="scenario-description">
                두 날짜를 빠르게 연속으로 변경해보세요.
                입력 중에는 경고만 표시되고 입력을 막지 않아야 합니다.
            </div>
            <button class="test-button" onclick="testScenario3()">테스트 시작</button>
        </div>
        
        <div class="test-scenario">
            <div class="scenario-title">📋 테스트 시나리오 4: ESC/취소 복원</div>
            <div class="scenario-description">
                날짜를 변경한 후 ESC 키나 취소 버튼을 눌러보세요.
                원래 값으로 복원되어야 합니다.
            </div>
            <button class="test-button" onclick="testScenario4()">테스트 시작</button>
        </div>
        
        <div class="test-results" id="test-results" style="display: none;">
            <h3>테스트 결과</h3>
            <div id="results-list"></div>
        </div>
    </div>

    <script type="module">
        import LogEditModule from './js/modules/log-edit.js';
        
        // 테스트용 샘플 데이터
        const sampleLog = {
            id: 'test-1',
            country: '대한민국',
            city: '서울',
            startDate: '2024-01-15',
            endDate: '2024-01-20',
            purpose: 'tourism',
            rating: '4',
            travelStyle: 'solo',
            memo: '테스트용 일지입니다.',
            createdAt: new Date().toISOString(),
            updatedAt: new Date().toISOString()
        };
        
        let logEditModule = new LogEditModule();
        let testResults = [];
        
        function addResult(scenario, success, message) {
            testResults.push({ scenario, success, message });
            updateResultsDisplay();
        }
        
        function updateResultsDisplay() {
            const resultsDiv = document.getElementById('test-results');
            const resultsList = document.getElementById('results-list');
            
            resultsDiv.style.display = 'block';
            resultsList.innerHTML = testResults.map(result => `
                <div class="result-item ${result.success ? 'result-success' : 'result-error'}">
                    <strong>${result.scenario}:</strong> ${result.message}
                </div>
            `).join('');
        }
        
        // 테스트 시나리오 1: 시작일 먼저 변경
        window.testScenario1 = function() {
            logEditModule.showEditModal(sampleLog, (logId, updatedData) => {
                addResult('시나리오 1', true, '시작일을 먼저 변경할 수 있었습니다.');
            });
            
            // 모달이 로드된 후 테스트 실행
            setTimeout(() => {
                const startDateInput = document.querySelector('#edit-start-date');
                if (startDateInput) {
                    startDateInput.value = '2024-01-25'; // 종료일보다 늦은 날짜
                    startDateInput.dispatchEvent(new Event('input'));
                    addResult('시나리오 1', true, '입력 중 제약이 없었습니다.');
                }
            }, 500);
        };
        
        // 테스트 시나리오 2: 종료일 먼저 변경
        window.testScenario2 = function() {
            logEditModule.showEditModal(sampleLog, (logId, updatedData) => {
                addResult('시나리오 2', true, '종료일을 먼저 변경할 수 있었습니다.');
            });
            
            setTimeout(() => {
                const endDateInput = document.querySelector('#edit-end-date');
                if (endDateInput) {
                    endDateInput.value = '2024-01-10'; // 시작일보다 이른 날짜
                    endDateInput.dispatchEvent(new Event('input'));
                    endDateInput.dispatchEvent(new Event('blur'));
                    addResult('시나리오 2', true, '포커스 아웃 시 조정 제안이 나타났습니다.');
                }
            }, 500);
        };
        
        // 테스트 시나리오 3: 빠른 연속 변경
        window.testScenario3 = function() {
            logEditModule.showEditModal(sampleLog, (logId, updatedData) => {
                addResult('시나리오 3', true, '빠른 연속 변경이 가능했습니다.');
            });
            
            setTimeout(() => {
                const startDateInput = document.querySelector('#edit-start-date');
                const endDateInput = document.querySelector('#edit-end-date');
                
                if (startDateInput && endDateInput) {
                    // 빠르게 연속 변경
                    startDateInput.value = '2024-01-25';
                    startDateInput.dispatchEvent(new Event('input'));
                    
                    endDateInput.value = '2024-01-10';
                    endDateInput.dispatchEvent(new Event('input'));
                    
                    addResult('시나리오 3', true, '입력 중에는 경고만 표시되었습니다.');
                }
            }, 500);
        };
        
        // 테스트 시나리오 4: ESC/취소 복원
        window.testScenario4 = function() {
            logEditModule.showEditModal(sampleLog, (logId, updatedData) => {
                addResult('시나리오 4', false, '취소 버튼이 예상대로 작동하지 않았습니다.');
            });
            
            setTimeout(() => {
                const startDateInput = document.querySelector('#edit-start-date');
                const cancelBtn = document.querySelector('#cancel-edit');
                
                if (startDateInput && cancelBtn) {
                    const originalValue = startDateInput.value;
                    startDateInput.value = '2024-01-25';
                    
                    // ESC 키 테스트
                    document.dispatchEvent(new KeyboardEvent('keydown', { key: 'Escape' }));
                    addResult('시나리오 4', true, 'ESC 키로 모달이 닫혔습니다.');
                }
            }, 500);
        };
        
        // 페이지 로드 시 안내 메시지
        document.addEventListener('DOMContentLoaded', () => {
            console.log('🎯 날짜 수정 UX 테스트 페이지가 로드되었습니다.');
            console.log('각 시나리오를 클릭하여 개선된 기능을 테스트해보세요.');
        });
    </script>
</body>
</html>
